"use strict";var regexs={rule:/^(.+?)\((.+)\)$/,numericRegex:/^[0-9]+$/,email:/^[a-zA-Z0-9]+([._\\-]*[a-zA-Z0-9])*@([a-zA-Z0-9]+[-a-zA-Z0-9]*[a-zA-Z0-9]+.){1,63}[a-zA-Z0-9]+$/,ip:/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])((\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])){3}|(\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])){5})$/,fax:/^(([0\+]\d{2,3}-)?(0\d{2,3})-)(\d{7,8})(-(\d{3,}))?$/,phone:/^1[0-9]{10}$/,url:/[a-zA-z]+:\/\/[^\s]/,money:/^(0|[1-9]\d*)(\.\d+)?$/,english:/^[A-Za-z]+$/,chinese:/^[\u0391-\uFFE5]+$/,percent:/^(?:[1-9][0-9]?|100)(?:\.[0-9]{1,2})?$/},_testHook={is_email:function(e){return regexs.email.test(backVal(e))},is_ip:function(e){return regexs.ip.test(backVal(e))},is_fax:function(e){return regexs.fax.test(backVal(e))},is_tel:function(e){return regexs.fax.test(backVal(e))},is_phone:function(e){return regexs.phone.test(backVal(e))},is_url:function(e){return regexs.url.test(backVal(e))},is_money:function(e){return regexs.money.test(backVal(e))},is_english:function(e){return regexs.english.test(backVal(e))},is_chinese:function(e){return regexs.chinese.test(backVal(e))},is_percent:function(e){return regexs.percent.test(backVal(e))},required:function(e){var t=backVal(e);return"checkbox"===e.type||"radio"===e.type?!0===e.checked:null!==t&&""!==t},max_length:function(e,t){return!!regexs.numericRegex.test(t)&&backVal(e).length<=parseInt(t,10)},min_length:function(e,t){return!!regexs.numericRegex.test(t)&&backVal(e).length>=parseInt(t,10)},same:function(e,t){return backVal(e)==backVal(t)},different:function(e,t){return!this.same(e,t)},contains:function(e,t){return backVal(e)==t},accepted:function(e){var t=backVal(e);return"YES"==t.toUpperCase()||"ON"==t.toUpperCase()||1==t||0==t}};function attributeValue(e,t){var r,n;if(!(0<e.length)||"radio"!==e[0].type&&"checkbox"!==e[0].type)return e[t];for(r=0,n=e.length;r<n;r++)if(e[r].checked)return e[r][t]}function camelCase(e){return e.replace(/\_([a-z])/g,function(e,t){return t.toUpperCase()})}function backVal(e){return"string"==typeof e?e:e.value}function _formElm(e){return"object"==typeof e?e:document.forms[e]}function addField(e,t,r){for(var n in e.fields[r]={name:r,display:t.display||r,rules:t.rules,id:null,element:null,type:null,value:null,checked:null},t)t.hasOwnProperty(n)&&/^regexp\_/.test(n)&&(regexs[n]=t[n])}var Validator=function(){function e(e,t,r){for(var n in _testHook)this[camelCase(n)]=_testHook[n];if(this.callback=r||function(){},this.errors=[],this.fields={},this.handles={},e){this.form=_formElm(e)||{};for(var a=0,s=t.length;a<s;a++){var i=t[a];(i.name||i.names)&&i.rules?addField(this,i,i.name):console.warn(i)}var l,u=this.form.onsubmit;this.form.onsubmit=(l=this,function(e){try{return l.validate(e)&&(void 0===u||u())}catch(e){console.log(e)}})}}return e.prototype.validate=function(e){if(this._passes)return this;for(var t in this.handles.ok=!0,this.handles.evt=e,this.errors=[],this.fields)if(this.fields.hasOwnProperty(t)){var r=this.fields[t]||{},n=this.form[r.name];n&&void 0!==n&&(r.id=attributeValue(n,"id"),r.element=n,r.type=0<n.length?n[0].type:n.type,r.value=attributeValue(n,"value"),r.checked=attributeValue(n,"checked"),this._validateField(r))}return"function"==typeof this.callback&&this.callback(this,e),0<this.errors.length&&(e&&e.preventDefault?e.preventDefault():event&&(event.returnValue=!1)),this},e.prototype.passes=function(){this._passes=!0},e.prototype._validateField=function(c){for(var f=c.rules.split("|"),d=!c.value||""===c.value||void 0===c.value,e=function(e,t){var r=f[e],n=regexs.rule.exec(r),a=null,s=!1;if(n&&(r=n[1],a=n[2]),d&&-1===f.indexOf("required"))return"continue";if("function"==typeof _testHook[r]&&(_testHook[r].apply(h,[c,a])||(s=!0)),regexs[r]&&/^regexp\_/.test(r)&&(regexs[r].test(c.value)||(s=!0)),s){var i=c.display.split("|")[e]&&c.display.split("|")[e].replace("{{"+c.name+"}}",c.value),l=void 0,u=void 0;for(u=0;u<h.errors.length;u+=1)c.element===h.errors[u].element&&(l=h.errors[u]);var o=l||{id:c.id,display:c.display,element:c.element,name:c.name,message:i,messages:[],rule:r};o.messages.push(i),l||h.errors.push(o)}},h=this,t=0,r=f.length;t<r;t++)e(t);return this},e}();